!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("crypto"),require("fs"),require("path"),require("stream"),require("http")):"function"==typeof define&&define.amd?define(["exports","crypto","fs","path","stream","http"],t):t(e["rollup-plugin-hotreload"]={},e.crypto,e.fs,e.path,e.stream,e.http)}(this,function(e,i,n,d,t,r){"use strict";r=r&&r.hasOwnProperty("default")?r.default:r;var a={reqNow:null,hashKey:i.randomBytes(6).toString("hex"),copyStr:null,isAppend:!1},c=[],l=!1,f=null,s=[],h=r.createServer().listen(9999);var u=new t.Transform({transform:function(e,t,r){a.isAppend||null===a.copyStr||(this.push("var loadfilePath = ["+a.copyStr+"];\n"),a.isAppend=!0),this.push(e)}});e.rph=function(t){if(!t.rootDir)throw TypeError("rootDir is needed!");if(!Array.isArray(t.buildPaths))throw SyntaxError("buildPaths must have at least ONE file");if(!t.templateHtmlPath)throw SyntaxError("templatePath html is needed!");f=t.rootDir,c=t.buildPaths.slice();for(var e=!!t.isStopRPH,r=0;r<c.length;r++){var o=c[r];if(!o[0]&&!o[1])throw TypeError("both the first: build file path and     the second: source path are needed!");s=s.concat('"'+o[0]+'"')}return a.copyStr=s.join(","),{name:"rollup-plugin-hotreload",ongenerate:function(){e||(this.hashKey=i.randomBytes(6).toString("hex"),h&&h.on("request",function(e,t){"/rollup-plugin-hotreload"!==e.url||t.finished||(this.reqNow=e,t.writeHead(200,{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive","Access-Control-Allow-Origin":"*"}),t.write("data: "+this.hashKey+"\n\n"),t.end())}.bind(this)),null!==this.reqNow&&this.reqNow.on("close",function(){console.warn("close isReload")}))}.bind(a),onwrite:function(e){l||(console.log("isCopyFilePathToHotreloadJs-> ",l),n.createReadStream(d.join(__dirname,"hotreload.min.js")).pipe(u).pipe(n.createWriteStream(f+"/hotreload.min.js")),l=!0),n.readFile(t.templateHtmlPath,"utf8",function(e,t){if(e)throw e;var r=[t.slice(0,t.indexOf("</body>")),'<script type="text/javascript" src="hotreload.min.js"><\/script>\n',t.slice(t.indexOf("</body>"),t.length)].join("");n.writeFile("./"+f+"/index.html",r,function(e){if(e)throw e})})}}},e.rphMultibundles=function(e,t){if(!Array.isArray)throw SyntaxError("Array.isArray is not supported!");for(var r,o,i,n,a,l,s,h=[],u=0;u<c.length;u++){var p=c[u];if(!p[0]&&!p[1])throw TypeError("both the first: build file path and       the second: source path are needed!");h=h.concat((r=e,o=t,i=d.join(f,p[0]),n=p[1],a=void 0,a={module:null,outputPath:null},l=Object.assign({},r.output,{file:i}),s=Object.assign({},r,{input:d.join(o,n),output:l}),a.module=s,a.outputPath=i,a).module)}return h},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.min.js.map
