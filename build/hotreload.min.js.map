{"version":3,"file":"hotreload.min.js","sources":["../lib/hotreload.js"],"sourcesContent":["/**\n * load js in html on the client side\n */\n\n/**** dynamic inject load js file path ****/\n/**** NOTE: all relative file path to hotreload.js********/\n\n\nfunction insertjs() {\n  //* READ EACH JS FILE*//\n  if (loadfilePath === undefined || loadfilePath === null)\n    throw TypeError(\"loadfilePath is not defined\");\n  for (var i = 0; i < loadfilePath.length; i++) {\n    var script = document.createElement(\"script\");\n    script.id = \"rph-id\" + i;\n    script.src = loadfilePath[i];\n    script.type = \"text/javascript\";\n    document.body.appendChild(script);\n  }\n}\nfunction reloadjs() {\n  var scripts = [];\n  for (var j = 0; j < loadfilePath.length; j++) {\n    scripts = scripts.concat(document.getElementById(\"rph-id\" + j));\n  }\n  if (scripts) {\n    for (var k = 0; k < scripts.length; k++) {\n      document.body.removeChild(scripts[k]);\n    }\n    insertjs();\n  }\n}\n\n\n/************USE EVENTSOURCE*****************/\ninsertjs();\nwindow.___hashkey___ = \"\";\nif (!!window.EventSource) {\n\n  var timeout = 500; // 3s\n  var source = null;\n  window.___lastupdate___ = new Date();\n  function createEventSource() {\n    source = new EventSource('http://localhost:9999/rollup-plugin-hotreload');\n    source.onmessage = function (e) {\n      if (e.data && (window.___hashkey___ === \"\" || window.___hashkey___ !== e.data)) {\n        reloadjs();\n        window.___hashkey___ = e.data;\n        window.___lastupdate___ = new Date();\n      }\n    };\n    source.onerror = function (e) {\n      source.close();\n    };\n  }\n  // timeout to disconnect\n  function checkConnection() {\n    if (source.readyState === 2 && new Date() - window.___lastupdate___ > timeout / 2) {\n      createEventSource();\n    }\n  }\n  try {\n    createEventSource();\n    setInterval(checkConnection, timeout);\n  } catch (err) {\n    throw err;\n  }\n} else {\n  throw new Error(\"Browser does not support EventSource \\\n  Use EventSource Polyfill instead!\");\n}\n\n"],"names":["insertjs","undefined","loadfilePath","TypeError","i","length","script","document","createElement","id","src","type","body","appendChild","window","___hashkey___","EventSource","Error","createEventSource","onmessage","e","data","scripts","j","concat","getElementById","k","removeChild","___lastupdate___","Date","onerror","close","timeout","source","readyState","err"],"mappings":"uJAQA,SAASA,YAEcC,IAAjBC,cAA+C,OAAjBA,aAChC,MAAMC,UAAU,mCACb,IAAIC,EAAI,EAAGA,EAAIF,aAAaG,OAAQD,IAAK,KACxCE,EAASC,SAASC,cAAc,YAC7BC,GAAK,SAAWL,IAChBM,IAAMR,aAAaE,KACnBO,KAAO,2BACLC,KAAKC,YAAYP,IAoB9B,GAFAN,IACAc,OAAOC,cAAgB,IACjBD,OAAOE,kBA+BL,IAAIC,MAAM,gFA1BPC,EAAT,cACW,IAAIF,YAAY,kDAClBG,UAAY,SAAUC,IACvBA,EAAEC,MAAkC,KAAzBP,OAAOC,eAAwBD,OAAOC,gBAAkBK,EAAEC,QAzB/E,mBACMC,EAAU,GACLC,EAAI,EAAGA,EAAIrB,aAAaG,OAAQkB,MAC7BD,EAAQE,OAAOjB,SAASkB,eAAe,SAAWF,OAE1DD,EAAS,KACN,IAAII,EAAI,EAAGA,EAAIJ,EAAQjB,OAAQqB,aACzBd,KAAKe,YAAYL,EAAQI,mBAoBzBX,cAAgBK,EAAEC,YAClBO,iBAAmB,IAAIC,SAG3BC,QAAU,SAAUV,KAClBW,UAbPC,EAAU,IACVC,EAAS,YACNL,iBAAmB,IAAIC,yBAe9B,WAC4B,IAAtBI,EAAOC,YAAoB,IAAIL,KAASf,OAAOc,iBAAmBI,EAAU,QAMnDA,GAC7B,MAAOG,SACDA"}