{"version":3,"file":"hotreload.min.js","sources":["../lib/hotreload.js"],"sourcesContent":["/**\n * load js in html on the client side\n */\n\n/**** dynamic inject load js file path ****/\n/**** NOTE: all relative file path to hotreload.js********/\n\n\nfunction insertjs() {\n  //* READ EACH JS FILE*//\n  if (loadfilePath === undefined || loadfilePath === null)\n    throw TypeError(\"loadfilePath is not defined\");\n  for (var i = 0; i < loadfilePath.length; i++) {\n    var script = document.createElement(\"script\");\n    script.id = \"rph-id\" + i;\n    script.src = loadfilePath[i];\n    script.type = \"text/javascript\";\n    document.body.appendChild(script);\n  }\n}\nfunction reloadjs() {\n  var scripts = [];\n  for (var j = 0; j < loadfilePath.length; j++) {\n    scripts = scripts.concat(document.getElementById(\"rph-id\" + j));\n  }\n  if (scripts) {\n    for (var k = 0; k < scripts.length; k++) {\n      document.body.removeChild(scripts[k]);\n    }\n    insertjs();\n  }\n}\n\n\n/************USE EVENTSOURCE*****************/\ninsertjs();\nwindow.___hashkey___ = \"\";\nif (!!window.EventSource) {\n\n  var timeout = 500; // 3s\n  var source = null;\n  window.___lastupdate___ = new Date();\n  function createEventSource() {\n    source = new EventSource('http://localhost:9999/rollup-plugin-hotreload');\n    source.onmessage = function (e) {\n      if (e.data && (window.___hashkey___ === \"\" || window.___hashkey___ !== e.data)) {\n        reloadjs();\n        window.___hashkey___ = e.data;\n        window.___lastupdate___ = new Date();\n      }\n    };\n    source.onerror = function (e) {\n      source.close();\n    };\n  }\n  // timeout to disconnect\n  function checkConnection() {\n    if (source.readyState === 2 && new Date() - window.___lastupdate___ > timeout / 2) {\n      createEventSource();\n    }\n  }\n  try {\n    createEventSource();\n    setInterval(checkConnection, timeout);\n  } catch (err) {\n    throw err;\n  }\n} else {\n  throw new Error(\"Browser does not support EventSource \\\n  Use EventSource Polyfill instead!\");\n}\n\n"],"names":["insertjs","loadfilePath","undefined","TypeError","i","length","script","document","createElement","id","src","type","body","appendChild","reloadjs","scripts","j","concat","getElementById","k","removeChild","window","___hashkey___","EventSource","createEventSource","onmessage","e","data","___lastupdate___","Date","onerror","close","checkConnection","source","readyState","timeout","err","Error"],"mappings":";;;;;;AAAA;;;;;;;AAQA,SAASA,QAAT,GAAoB;;MAEdC,iBAAiBC,SAAjB,IAA8BD,iBAAiB,IAAnD,EACE,MAAME,UAAU,6BAAV,CAAN;OACG,IAAIC,IAAI,CAAb,EAAgBA,IAAIH,aAAaI,MAAjC,EAAyCD,GAAzC,EAA8C;QACxCE,SAASC,SAASC,aAAT,CAAuB,QAAvB,CAAb;WACOC,EAAP,GAAY,WAAWL,CAAvB;WACOM,GAAP,GAAaT,aAAaG,CAAb,CAAb;WACOO,IAAP,GAAc,iBAAd;aACSC,IAAT,CAAcC,WAAd,CAA0BP,MAA1B;;;AAGJ,SAASQ,QAAT,GAAoB;MACdC,UAAU,EAAd;OACK,IAAIC,IAAI,CAAb,EAAgBA,IAAIf,aAAaI,MAAjC,EAAyCW,GAAzC,EAA8C;cAClCD,QAAQE,MAAR,CAAeV,SAASW,cAAT,CAAwB,WAAWF,CAAnC,CAAf,CAAV;;MAEED,OAAJ,EAAa;SACN,IAAII,IAAI,CAAb,EAAgBA,IAAIJ,QAAQV,MAA5B,EAAoCc,GAApC,EAAyC;eAC9BP,IAAT,CAAcQ,WAAd,CAA0BL,QAAQI,CAAR,CAA1B;;;;;;;AAQNnB;AACAqB,OAAOC,aAAP,GAAuB,EAAvB;AACA,IAAI,CAAC,CAACD,OAAOE,WAAb,EAA0B;MAKfC,iBALe,GAKxB,SAASA,iBAAT,GAA6B;aAClB,IAAID,WAAJ,CAAgB,+CAAhB,CAAT;WACOE,SAAP,GAAmB,UAAUC,CAAV,EAAa;UAC1BA,EAAEC,IAAF,KAAWN,OAAOC,aAAP,KAAyB,EAAzB,IAA+BD,OAAOC,aAAP,KAAyBI,EAAEC,IAArE,CAAJ,EAAgF;;eAEvEL,aAAP,GAAuBI,EAAEC,IAAzB;eACOC,gBAAP,GAA0B,IAAIC,IAAJ,EAA1B;;KAJJ;WAOOC,OAAP,GAAiB,UAAUJ,CAAV,EAAa;aACrBK,KAAP;KADF;GAdsB;;;;MAmBfC,eAnBe,GAmBxB,SAASA,eAAT,GAA2B;QACrBC,OAAOC,UAAP,KAAsB,CAAtB,IAA2B,IAAIL,IAAJ,KAAaR,OAAOO,gBAApB,GAAuCO,UAAU,CAAhF,EAAmF;;;GApB7D;;MAEpBA,UAAU,GAAd,CAFwB;MAGpBF,SAAS,IAAb;SACOL,gBAAP,GAA0B,IAAIC,IAAJ,EAA1B;;MAoBI;;gBAEUG,eAAZ,EAA6BG,OAA7B;GAFF,CAGE,OAAOC,GAAP,EAAY;UACNA,GAAN;;CA5BJ,MA8BO;QACC,IAAIC,KAAJ,CAAU;oCAAV,CAAN;;;;;"}